<!doctype html><html lang=en-uk dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="External localisation # Expand this text or click the yaml file to find all the assigned aruco tags Aruco marker setup ↕ For an updated version of what each marker does please check the following yaml file, (as it is the one the pi will read), (website might be out of date).
Aruco Tag functionality Aruco Tag functionality Aruco Tag functionality #0 robot 0 #10 None #20 5s Broadcast #1 robot 1 #11 None #21 10s Broadcast #2 robot 2 #12 OK #22 no Broadcast #3 robot 3 #13 Shutdown #23 None #4 robot 4 #14 Frame ENU #24 None #5 robot 5 #15 Frame NED #25 None #6 robot 6 #16 Broadcast at logging speed #26 None #7 robot 7 #17 Calibration #27 None #8 robot 8 #18 1s Broadcast #28 None #9 robot 9 #19 2s Broadcast #29 None yaml file ArUco setup Checklist # Before Turning on the Pi # Ensure Camera is in centre of tank and is facing the tank, (and is connected to the pi)"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="External localisation"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="http://ocean-perception.github.io/mobile_robotics/external_localisation/"><title>External localisation | Mobile Robotics documentation</title><link rel=manifest href=/mobile_robotics/manifest.json><link rel=icon href=/mobile_robotics/favicon.png type=image/x-icon><link rel=stylesheet href=/mobile_robotics/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css integrity="sha256-xYKS02sYtnVoCrm66iApIEU3uDnqcvJYdG7A8yzo1sg=" crossorigin=anonymous><script defer src=/mobile_robotics/flexsearch.min.js></script>
<script defer src=/mobile_robotics/en.search.min.09fda046a640c1837291a46ae8b4baaa04ec2dc27c6ea9b3f99baceac81e498e.js integrity="sha256-Cf2gRqZAwYNykaRq6LS6qgTsLcJ8bqmz+Zus6sgeSY4=" crossorigin=anonymous></script>
<script defer src=/mobile_robotics/sw.min.6c62faa43e063351bb8db857ed6743bc77e390d2df184c1171b023c4fbfbe0c0.js integrity="sha256-bGL6pD4GM1G7jbhX7WdDvHfjkNLfGEwRcbAjxPv74MA=" crossorigin=anonymous></script>
<link rel=alternate type=application/rss+xml href=http://ocean-perception.github.io/mobile_robotics/external_localisation/index.xml title="Mobile Robotics documentation"></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/mobile_robotics/><img src=/mobile_robotics/logo.png alt=Logo><span>Mobile Robotics documentation</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/mobile_robotics/><strong>Home</strong></a></li><li><a href=/mobile_robotics/sensors/>Sensors</a></li><li><a href=/mobile_robotics/programming/>Programming</a></li><li><a href=/mobile_robotics/intelligent_mobile_robotics/>Mobile robotics</a></li><li><a href=/mobile_robotics/maritime_robotics/>Maritime robotics</a><ul><li><a href=/mobile_robotics/maritime_robotics/platform/>Platform</a></li></ul></li><li><a href=/mobile_robotics/external_localisation/ class=active>External localisation</a></li><li><a href=/mobile_robotics/pi_configuration/>Pi Configuration</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/mobile_robotics/svg/menu.svg class=book-icon alt=Menu></label>
<strong>External localisation</strong>
<label for=toc-control><img src=/mobile_robotics/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#aruco-setup-checklist>ArUco setup Checklist</a><ul><li><a href=#before-turning-on-the-pi>Before Turning on the Pi</a></li><li><a href=#when-pi-is-turned-on>When Pi is turned on</a></li></ul></li><li><a href=#broadcast-frequency>Broadcast Frequency,</a></li><li><a href=#setting-up-the-client-pis-robots>Setting up the Client Pi’s, (Robots)</a></li><li><a href=#debugging>Debugging</a></li></ul></nav></aside></header><article class=markdown><h1 id=external-localisation>External localisation
<a class=anchor href=#external-localisation>#</a></h1><p>Expand this text or click the yaml file to find all the assigned aruco tags<div class=book-expand><label><div class="book-expand-head flex justify-between"><span>Aruco marker setup</span>
<span>↕</span></div><input type=checkbox class=hidden><div class="book-expand-content markdown-inner"><p>For an updated version of what each marker does please check the following yaml file, (as it is the one the pi will read), (website might be out of date).</p><table><thead><tr><th>Aruco Tag</th><th>functionality</th><th>Aruco Tag</th><th>functionality</th><th>Aruco Tag</th><th>functionality</th></tr></thead><tbody><tr><td>#0</td><td>robot 0</td><td>#10</td><td>None</td><td>#20</td><td>5s Broadcast</td></tr><tr><td>#1</td><td>robot 1</td><td>#11</td><td>None</td><td>#21</td><td>10s Broadcast</td></tr><tr><td>#2</td><td>robot 2</td><td>#12</td><td>OK</td><td>#22</td><td>no Broadcast</td></tr><tr><td>#3</td><td>robot 3</td><td>#13</td><td>Shutdown</td><td>#23</td><td>None</td></tr><tr><td>#4</td><td>robot 4</td><td>#14</td><td>Frame ENU</td><td>#24</td><td>None</td></tr><tr><td>#5</td><td>robot 5</td><td>#15</td><td>Frame NED</td><td>#25</td><td>None</td></tr><tr><td>#6</td><td>robot 6</td><td>#16</td><td>Broadcast at logging speed</td><td>#26</td><td>None</td></tr><tr><td>#7</td><td>robot 7</td><td>#17</td><td>Calibration</td><td>#27</td><td>None</td></tr><tr><td>#8</td><td>robot 8</td><td>#18</td><td>1s Broadcast</td><td>#28</td><td>None</td></tr><tr><td>#9</td><td>robot 9</td><td>#19</td><td>2s Broadcast</td><td>#29</td><td>None</td></tr></tbody></table></div></label></div><a href=https://github.com/miquelmassot/uos_aruco_detector/tree/main/src/uos_aruco_detector/configuration target=_blank rel=noopener class=book-btn>yaml file</a></p><h2 id=aruco-setup-checklist>ArUco setup Checklist
<a class=anchor href=#aruco-setup-checklist>#</a></h2><h3 id=before-turning-on-the-pi>Before Turning on the Pi
<a class=anchor href=#before-turning-on-the-pi>#</a></h3><p>Ensure Camera is in centre of tank and is facing the tank, (and is connected to the pi)</p><p>Ensure No ArUco Markers Are visible in the Camera frame (flip them upside down to ensure they can’t be seen)</p><p>Ensure that the Router is turned on and that it’s Wifi led is on, (doesn’t need to be connected to the internet)</p><p>Turn On the Raspberry pi, (may take a while, if no monitor attached wait 1 minute to ensure everything has booted up before configuring)</p><p>When booting the Pi, the ArUco code should start automatically, therefore it is not necessary to connect a keyboard or mouse to the Pi. If desired, a monitor may be connected to transmit all the Pi’s Information, (recommended).</p><h3 id=when-pi-is-turned-on>When Pi is turned on
<a class=anchor href=#when-pi-is-turned-on>#</a></h3><p>To newly calibrate the origin location, place the Calibration tag (<strong>#27</strong>) where desired, (ensure it is flat and not moving), the origin will be located in the centre of this marker. Then Show the ‘OK’ (<strong>#22</strong>) tag in frame. Only when the 2 tags are recognised in frame will the code save the position.</p><p>If you want to use the old Calibrated Origin, then the previous step can be skipped by only showing the ‘OK’ (<strong>#22</strong>) in frame.</p><p>If the step was done incorrectly, proceed to show the Shut-down tag (<strong>#13</strong>) together with the ‘OK’ (<strong>#22</strong>) tag in frame. WAIT 1 minute (to ensure that pi properly switches off), then proceed to turn the pi’s power off then on. (This should reboot the program)</p><p><em><strong>The Setup-phase is now completed</strong></em></p><h2 id=broadcast-frequency>Broadcast Frequency,
<a class=anchor href=#broadcast-frequency>#</a></h2><p>(frequency at which the Server Pi will send the coordinates to the Client Pi’s) has a possible configuration of ‘logging speed’ (~10th of a second), 1s, 2s, 5s, 10s and never. On boot the pi will be initially setup to send the information every 1s.</p><p>To change the show the desired Broadcast Frequency tag (shown in table below) in frame, with the ‘OK’ tag (#49).</p><table><thead><tr><th>Aruco Tag</th><th>Broadcast speed</th></tr></thead><tbody><tr><td>#16</td><td>at logging speed</td></tr><tr><td>#18</td><td>every 1s</td></tr><tr><td>#19</td><td>every 2s</td></tr><tr><td>#20</td><td>every 5s</td></tr><tr><td>#21</td><td>every 10s</td></tr><tr><td>#22</td><td>no broadcast</td></tr></tbody></table><p>If a Display is connected to the Pi, the broadcast frequency will be visible as a frame will blink around the screen at every broadcasted interval, (when an ArUco marker is being shown).</p><p>The Server Pi should Now be all set!</p><p>To Turn Off the Pi show the Shut-down tag (<strong>#13</strong>) together with the ‘OK’ (<strong>#22</strong>) tag in frame. WAIT 1 minute (to ensure that pi properly switches off).</p><p>The Pi will Log all the ArUco tag information in a csv file of which’ name will be ‘***.csv’ where # is the ArUco Tag’s ID. All these files will be stored in a folder named after the exact time the Pi was booted up, example: ‘2022_07_25_12_34_18’, where is in this order: (‘Year_Month_Day_Hour_Minute_Second’).</p><p>All information will be saved on the ssd card connected separately. This can be disconnected when the Pi is of to read the information from another computer. (there will be a long usb extension so that it is easily accessible).</p><h2 id=setting-up-the-client-pis-robots>Setting up the Client Pi’s, (Robots)
<a class=anchor href=#setting-up-the-client-pis-robots>#</a></h2><p>Make sure all packages have been installed and the Chrony configuration have been made.</p><p>Open the Python file</p><p>Run the file</p><h2 id=debugging>Debugging
<a class=anchor href=#debugging>#</a></h2><div class=book-expand><label><div class="book-expand-head flex justify-between"><span>Expand</span>
<span>↕</span></div><input type=checkbox class=hidden><div class="book-expand-content markdown-inner"><p>If robot is not receiving information</p><p>Uncomment the <code>print(broadcast_data)</code> line</p><p>Place an Aruco Tag infront of the camera, if something is being printed in the console, this means that the aruco tags are being recognised. Therefore you can proceed to the next step (Remember position data will only be broadcasted from the Server Robot once the setup phase is complete) :</p><p>Ensure The Client (Robot) Pi is connected to <strong>local Router</strong>, as this is the network on which the pi will broadcast the data, if your trying this at home, make sure that the both the host and your pi are connected to the same local network, (it will not work through public wifi&rsquo;s such as the Universities Eduroam)</p><p>Ensure the Port to the one shown on screen from the Raspberry pi, (if so change variable called port to one shown on Server Pi )</p><p>Ensure no Other code has been altered other than what has been instructed.</p><p>If nothing is still being received please ask help from a member of staff.</p></div></label></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/ocean-perception/mobile_robotics/commit/8c6c56a9e1256325f62fafd341de315baacc9e8a title='Last modified by Miquel Massot | Sep 6, 2022' target=_blank rel=noopener><img src=/mobile_robotics/svg/calendar.svg class=book-icon alt=Calendar>
<span>Sep 6, 2022</span></a></div><div><a class="flex align-center" href=https://github.com/ocean-perception/mobile_robotics/edit/main/content/external_localisation/_index.md target=_blank rel=noopener><img src=/mobile_robotics/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#aruco-setup-checklist>ArUco setup Checklist</a><ul><li><a href=#before-turning-on-the-pi>Before Turning on the Pi</a></li><li><a href=#when-pi-is-turned-on>When Pi is turned on</a></li></ul></li><li><a href=#broadcast-frequency>Broadcast Frequency,</a></li><li><a href=#setting-up-the-client-pis-robots>Setting up the Client Pi’s, (Robots)</a></li><li><a href=#debugging>Debugging</a></li></ul></nav></div></aside></main></body></html>